/api/sales:
  post:
    summary: Record a new sale.
    description: Records a new sale, updates the sales history, and decreases the stock quantity of the sold products.
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              products:
                type: array
                items:
                  type: object
                  properties:
                    productId:
                      type: string
                      example: abc-123-xyz
                    quantity:
                      type: integer
                      example: 2
    responses:
      '201':
        description: Sale recorded successfully.
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: Sale recorded successfully.
                sale:
                  type: object
                  properties:
                    id:
                      type: string
                      example: uuid-de-la-venta
                    date:
                      type: string
                      format: date-time
                      example: '2025-05-18T15:30:00.000Z'
                    products:
                      type: array
                      items:
                        type: object
                        properties:
                          productId:
                            type: string
                            example: abc-123-xyz
                          name:
                            type: string
                            example: Brand X Potato Chips
                          quantity:
                            type: integer
                            example: 2
                          unitPrice:
                            type: number
                            format: float
                            example: 1.50
                          totalPrice:
                            type: number
                            format: float
                            example: 3.00
                    totalSaleAmount:
                      type: number
                      format: float
                      example: 3.00
      '400':
        description: Error if no products provided, product not found, or insufficient stock.
    tags:
      - Sales

/api/sales/history:
  get:
    summary: Get the history of all sales.
    description: Returns a list of all recorded sales.
    responses:
      '200':
        description: List of all sales records.
        content:
          application/json:
            schema:
              type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                    example: uuid-de-la-venta
                  date:
                    type: string
                    format: date-time
                    example: '2025-05-18T15:30:00.000Z'
                  products:
                    type: array
                    items:
                      type: object
                      properties:
                        productId:
                          type: string
                          example: abc-123-xyz
                        name:
                          type: string
                          example: Brand X Potato Chips
                        quantity:
                          type: integer
                          example: 2
                        unitPrice:
                          type: number
                          format: float
                          example: 1.50
                        totalPrice:
                          type: number
                          format: float
                          example: 3.00
                  totalSaleAmount:
                    type: number
                    format: float
                    example: 3.00
    tags:
      - Sales

/api/sales/{saleId}/invoice:
  get:
    summary: Descargar factura de venta en PDF
    description: Genera y descarga la factura en formato PDF para una venta específica.
    tags:
      - Sales
    parameters:
      - in: path
        name: saleId
        required: true
        description: ID de la venta para la cual se generará la factura.
        schema:
          type: string
    responses:
      '200':
        description: Archivo PDF de la factura.
        content:
          application/pdf:
            schema:
              type: string
              format: binary
      '404':
        description: Venta no encontrada.
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: "Sale with ID \"some-sale-id\" not found."
      '500':
        description: Error al generar el PDF de la factura.
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: "Failed to generate invoice PDF."